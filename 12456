import logging
from telegram import Update, InlineKeyboardButton, InlineKeyboardMarkup
from telegram.ext import Application, CommandHandler, CallbackQueryHandler, ContextTypes

# –í–∫–ª—é—á–∞–µ–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    level=logging.INFO
)

# –¢–æ–∫–µ–Ω, –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –æ—Ç BotFather
TOKEN = '7027633111:AAGoS4O6J_ZWi80nZ7ZwHO-ssFY4s22iZdQ'  # –ó–∞–º–µ–Ω–∏—Ç–µ 'YOUR_TOKEN_HERE' –Ω–∞ –≤–∞—à —Ç–æ–∫–µ–Ω

# –°–ª–æ–≤–∞—Ä—å —Å –æ–ø–∏—Å–∞–Ω–∏—è–º–∏ —Ç–∏–ø–æ–≤ –ª–∏—á–Ω–æ—Å—Ç–∏
PERSONALITY_DESCRIPTIONS = {
    'type1': '–û–ø–∏—Å–∞–Ω–∏–µ –ª–∏—á–Ω–æ—Å—Ç–∏ —Ç–∏–ø–∞ 1...',
    'type2': '–û–ø–∏—Å–∞–Ω–∏–µ –ª–∏—á–Ω–æ—Å—Ç–∏ —Ç–∏–ø–∞ 2...',
    'type3': '–û–ø–∏—Å–∞–Ω–∏–µ –ª–∏—á–Ω–æ—Å—Ç–∏ —Ç–∏–ø–∞ 3...',
    'type4': '–û–ø–∏—Å–∞–Ω–∏–µ –ª–∏—á–Ω–æ—Å—Ç–∏ —Ç–∏–ø–∞ 4...',
    'type5': '–û–ø–∏—Å–∞–Ω–∏–µ –ª–∏—á–Ω–æ—Å—Ç–∏ —Ç–∏–ø–∞ 5...',
    'type6': '–û–ø–∏—Å–∞–Ω–∏–µ –ª–∏—á–Ω–æ—Å—Ç–∏ —Ç–∏–ø–∞ 6...',
    'type7': '–û–ø–∏—Å–∞–Ω–∏–µ –ª–∏—á–Ω–æ—Å—Ç–∏ —Ç–∏–ø–∞ 7...',
    'type8': '–û–ø–∏—Å–∞–Ω–∏–µ –ª–∏—á–Ω–æ—Å—Ç–∏ —Ç–∏–ø–∞ 8...',
}

# –°—Å—ã–ª–∫–∏ –Ω–∞ –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –ª–∏—á–Ω–æ—Å—Ç–∏
PERSONALITY_LINKS = {
    'type1': 'https://t.me/CaltOf/103',
    'type2': 'https://t.me/CaltOf/105',
    'type3': 'https://t.me/CaltOf/107',
    'type4': 'https://t.me/CaltOf/109',
    'type5': 'https://t.me/CaltOf/111',
    'type6': 'https://t.me/CaltOf/113',
    'type7': 'https://t.me/CaltOf/115',
    'type8': 'https://t.me/CaltOf/117',
}

# –ù–∞–∑–≤–∞–Ω–∏—è —Ç–∏–ø–æ–≤ –ª–∏—á–Ω–æ—Å—Ç–∏
PERSONALITY_NAMES = {
    'type1': 'üí¨–ú–∞—Å—Ç–µ—Ä —Å–ª–æ–≤–∞: –í–µ—Ä–±–∞–ª—å–Ω–æ-–ª–∏–Ω–≥–≤–∏—Å—Ç–∏—á–µ—Å–∫–∏–π',
    'type2': 'üß†–ó–∞–∫–æ–Ω—ã –º—ã—Å–ª–∏: –õ–æ–≥–∏–∫–æ-–º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π',
    'type3': 'üé≤–§–æ—Ä–º—ã –∏ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ: –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π',
    'type4': 'üéº–ì–∞—Ä–º–æ–Ω–∏—è –∑–≤—É–∫–æ–≤: –ú—É–∑—ã–∫–∞–ª—å–Ω—ã–π —Ç–∏–ø',
    'type5': 'ü§∏‚Äç‚ôÇÔ∏è–ò—Å–∫—É—Å—Å—Ç–≤–æ –¥–≤–∏–∂–µ–Ω–∏—è: –ö–∏–Ω–µ—Å—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π',
    'type6': 'üó£Ô∏è–ú–∞—Å—Ç–µ—Ä–∞ –æ–±—â–µ–Ω–∏—è: –ò–Ω—Ç–µ—Ä–ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π',
    'type7': 'üßò‚Äç‚ôÇÔ∏è–ì–ª—É–±–∏–Ω—ã –¥—É—à–∏: –ò–Ω—Ç—Ä–∞–ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π',
    'type8': 'üß¨–ü–æ–∑–Ω–∞–Ω–∏–µ –ø—Ä–∏—Ä–æ–¥—ã: –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ-–Ω–∞—É—á–Ω—ã–π',
}

# –°–ª–æ–≤–∞—Ä—å —Å –æ–ø–∏—Å–∞–Ω–∏—è–º–∏ –∫–æ–º–±–∏–Ω–∞—Ü–∏–π —Ç–∏–ø–æ–≤ –ª–∏—á–Ω–æ—Å—Ç–∏
COMBINATION_DESCRIPTIONS = {
    ('type1', 'type2', 'type3'): {
        'link': 'https://t.me/CaltOf/124',
        'name': '–ê–Ω–∞–ª–∏—Ç–∏–∫-–∫–æ–º–º—É–Ω–∏–∫–∞—Ç–æ—Ä'
    },
    ('type1', 'type2', 'type4'): {
        'link': 'https://t.me/CaltOf/126',
        'name': '–ú—É–∑—ã–∫–∞–ª—å–Ω–æ-–∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ç–æ—Ä'
    },
    ('type1', 'type2', 'type5'): {
        'link': 'https://t.me/CaltOf/128',
        'name': '–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏—Ç–∏–∫'
    },
    ('type1', 'type2', 'type6'): {
        'link': 'https://t.me/CaltOf/130',
        'name': '–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –ª–∏–¥–µ—Ä'
    },
    ('type1', 'type2', 'type7'): {
        'link': 'https://t.me/CaltOf/132',
        'name': '–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π —Ñ–∏–ª–æ—Å–æ—Ñ'
    },
    ('type1', 'type2', 'type8'): {
        'link': 'https://t.me/CaltOf/134',
        'name': '–ù–∞—É—á–Ω—ã–π –ê–Ω–∞–ª–∏—Ç–∏–∫'
    },
    ('type1', 'type3', 'type4'): {
        'link': 'https://t.me/CaltOf/136',
        'name': '–¢–≤–æ—Ä—á–µ—Å–∫–∏–π –º—É–∑—ã–∫–∞–ª—å–Ω—ã–π –ø–∏—Å–∞—Ç–µ–ª—å'
    },
    ('type1', 'type3', 'type5'): {
        'link': 'https://t.me/CaltOf/138',
        'name': '–¢–≤–æ—Ä—á–µ—Å–∫–∏–π –≤–∏–∑—É–∞–ª—å–Ω—ã–π —Ç–∞–Ω—Ü–æ—Ä'
    },
    ('type1', 'type3', 'type6'): {
        'link': 'https://t.me/CaltOf/140',
        'name': '–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ç–æ—Ä'
    },
    ('type1', 'type3', 'type7'): {
        'link': 'https://t.me/CaltOf/142',
        'name': '–¢–≤–æ—Ä—á–µ—Å–∫–∏–π –≤–∏–∑—É–∞–ª—å–Ω—ã–π –º–µ–¥–∏—Ç–∞—Ç–æ—Ä'
    },
    ('type1', 'type3', 'type8'): {
        'link': 'https://t.me/CaltOf/144',
        'name': '–ö–æ–º–º—É–Ω–∏–∫–∞—Ç–∏–≤–Ω—ã–π –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å'
    },
    ('type1', 'type4', 'type5'): {
        'link': 'https://t.me/CaltOf/146',
        'name': '–¢–≤–æ—Ä—á–µ—Å–∫–∏–π —ç–∫—Å–ø—Ä–µ—Å—Å–∏–≤–Ω—ã–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ç–æ—Ä'
    },
    ('type1', 'type4', 'type6'): {
        'link': 'https://t.me/CaltOf/148',
        'name': '–≠–º–ø–∞—Ç–∏—á–Ω—ã–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ç–æ—Ä'
    },
    ('type1', 'type4', 'type7'): {
        'link': 'https://t.me/CaltOf/150',
        'name': '–¢–≤–æ—Ä—á–µ—Å–∫–∏–π –º—É–∑—ã–∫–∞–ª—å–Ω—ã–π –º–µ–¥–∏—Ç–∞—Ç–æ—Ä'
    },
    ('type1', 'type4', 'type8'): {
        'link': 'https://t.me/CaltOf/152',
        'name': '–¢–≤–æ—Ä—á–µ—Å–∫–∏–π –º—É–∑—ã–∫–∞–ª—å–Ω—ã–π –±–∏–æ–ª–æ–≥'
    },
    ('type1', 'type5', 'type6'): {
        'link': 'https://t.me/CaltOf/154',
        'name': '–¢–≤–æ—Ä—á–µ—Å–∫–∏–π —Å–ø–æ—Ä—Ç–∏–≤–Ω—ã–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ç–æ—Ä'
    },
    ('type1', 'type5', 'type7'): {
        'link': 'https://t.me/CaltOf/156',
        'name': '–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ-—Å–æ—Ü–∏–∞–ª—å–Ω—ã–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ç–æ—Ä'
    },
    ('type1', 'type5', 'type8'): {
        'link': 'https://t.me/CaltOf/158',
        'name': '–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –Ω–∞—É—á–Ω—ã–π –ø—Ä–∞–∫—Ç–∏–∫'
    },
    ('type1', 'type6', 'type7'): {
        'link': 'https://t.me/CaltOf/160',
        'name': '–≠–º–ø–∞—Ç–∏—á–Ω—ã–π –≤–∏–∑–∏–æ–Ω–µ—Ä'
    },
    ('type1', 'type6', 'type8'): {
        'link': 'https://t.me/CaltOf/162',
        'name': '–¢–≤–æ—Ä—á–µ—Å–∫–∏–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ç–∏–≤–Ω—ã–π —É—á—ë–Ω—ã–π'
    },
    ('type1', 'type7', 'type8'): {
        'link': 'https://t.me/CaltOf/164',
        'name': '–¢–≤–æ—Ä—á–µ—Å–∫–∏–π –ª–∏–Ω–≥–≤–∏—Å—Ç–∏—á–µ—Å–∫–∏–π —Ñ–∏–ª–æ—Å–æ—Ñ'
    },
    ('type2', 'type3', 'type4'): {
        'link': 'https://t.me/CaltOf/166',
        'name': '–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –≤–∏–∑—É–∞–ª—å–Ω—ã–π –º—É–∑—ã–∫–∞–Ω—Ç'
    },
    ('type2', 'type3', 'type5'): {
        'link': 'https://t.me/CaltOf/168',
        'name': '–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –≤–∏–∑—É–∞–ª—å–Ω—ã–π —Ç—Ä–µ–Ω–µ—Ä'
    },
    ('type2', 'type3', 'type6'): {
        'link': 'https://t.me/CaltOf/170',
        'name': '–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –≤–∏–∑—É–∞–ª—å–Ω—ã–π –ª–∏–¥–µ—Ä'
    },
    ('type2', 'type3', 'type7'): {
        'link': 'https://t.me/CaltOf/172',
        'name': '–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –≤–∏–∑—É–∞–ª—å–Ω—ã–π –º–µ–¥–∏—Ç–∞—Ç–æ—Ä'
    },
    ('type2', 'type3', 'type8'): {
        'link': 'https://t.me/CaltOf/174',
        'name': '–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –Ω–∞—É—á–Ω—ã–π –≤–∏–∑—É–∞–ª–∏–∑–∞—Ç–æ—Ä'
    },
    ('type2', 'type4', 'type5'): {
        'link': 'https://t.me/CaltOf/176',
        'name': '–†–∏—Ç–º–∏—á–Ω—ã–π –∞–Ω–∞–ª–∏—Ç–∏–∫-–¥–≤–∏–≥–∞—Ç–µ–ª—å'
    },
    ('type2', 'type4', 'type6'): {
        'link': 'https://t.me/CaltOf/178',
        'name': '–¢–≤–æ—Ä—á–µ—Å–∫–∏–π –≥–∞—Ä–º–æ–Ω–∏–∑–∞—Ç–æ—Ä'
    },
    ('type2', 'type4', 'type7'): {
        'link': 'https://t.me/CaltOf/180',
        'name': '–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –º—É–∑—ã–∫–∞–ª—å–Ω—ã–π –º–µ–¥–∏—Ç–∞—Ç–æ—Ä'
    },
    ('type2', 'type4', 'type8'): {
        'link': 'https://t.me/CaltOf/182',
        'name': '–ì–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–∏–π –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä'
    },
    ('type2', 'type5', 'type6'): {
        'link': 'https://t.me/CaltOf/184',
        'name': '–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π —Å–ø–æ—Ä—Ç–∏–≤–Ω—ã–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ç–æ—Ä'
    },
    ('type2', 'type5', 'type7'): {
        'link': 'https://t.me/CaltOf/186',
        'name': '–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π –º–µ–¥–∏—Ç–∞—Ç–æ—Ä'
    },
    ('type2', 'type5', 'type8'): {
        'link': 'https://t.me/CaltOf/188',
        'name': '–ù–∞—É—á–Ω–æ-–∫–∏–Ω–µ—Å—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏—Ç–∏–∫'
    },
    ('type2', 'type6', 'type7'): {
        'link': 'https://t.me/CaltOf/190',
        'name': '–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ç–∏–≤–Ω—ã–π –º–µ–¥–∏—Ç–∞—Ç–æ—Ä'
    },
    ('type2', 'type6', 'type8'): {
        'link': 'https://t.me/CaltOf/192',
        'name': '–†–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å–æ–∑–µ—Ä—Ü–∞—Ç–µ–ª—å'
    },
    ('type2', 'type7', 'type8'): {
        'link': 'https://t.me/CaltOf/194',
        'name': '–§–∏–ª–æ—Å–æ—Ñ–∏—á–µ—Å–∫–∏–π –ê–Ω–∞–ª–∏—Ç–∏–∫'
    },
    ('type3', 'type4', 'type5'): {
        'link': 'https://t.me/CaltOf/196',
        'name': '–¢–≤–æ—Ä—á–µ—Å–∫–∏–π –°–µ–Ω—Å–æ—Ä'
    },
    ('type3', 'type4', 'type6'): {
        'link': 'https://t.me/CaltOf/198',
        'name': '–ì–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–∏–π –°–æ-–¢–≤–æ—Ä–µ—Ü'
    },
    ('type3', 'type4', 'type7'): {
        'link': 'https://t.me/CaltOf/200',
        'name': '–¢–≤–æ—Ä—á–µ—Å–∫–∏–π —Ç—Ä–µ—Ö–º–µ—Ä–Ω—ã–π –º–µ–¥–∏—Ç–∞—Ç–æ—Ä'
    },
    ('type3', 'type4', 'type8'): {
        'link': 'https://t.me/CaltOf/202',
        'name': '–ì–∞—Ä–º–æ–Ω–∏—á–Ω—ã–π –ò–Ω–Ω–æ–≤–∞—Ç–æ—Ä'
    },
    ('type3', 'type5', 'type6'): {
        'link': 'https://t.me/CaltOf/204',
        'name': '–ö–æ–æ—Ä–¥–∏–Ω–∏—Ä—É—é—â–∏–π –õ–∏–¥–µ—Ä'
    },
    ('type3', 'type5', 'type7'): {
        'link': 'https://t.me/CaltOf/206',
        'name': '–ò–Ω—Ç—É–∏—Ç–∏–≤–Ω—ã–π –î–∏–Ω–∞–º–∏—Å—Ç'
    },
    ('type3', 'type5', 'type8'): {
        'link': 'https://t.me/CaltOf/208',
        'name': '–≠–∫–æ-–¥–∏–Ω–∞–º–∏—á–Ω—ã–π –í–∏–∑—É–∞–ª–∏–∑–∞—Ç–æ—Ä'
    },
    ('type3', 'type6', 'type7'): {
        'link': 'https://t.me/CaltOf/210',
        'name': '–¢–≤–æ—Ä—á–µ—Å–∫–∏–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ç–∏–≤–Ω—ã–π –º–µ–¥–∏—Ç–∞—Ç–æ—Ä'
    },
    ('type3', 'type6', 'type8'): {
        'link': 'https://t.me/CaltOf/212',
        'name': '–¢–≤–æ—Ä—á–µ—Å–∫–∏–π –Ω–∞—É—á–Ω—ã–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ç–æ—Ä'
    },
    ('type3', 'type7', 'type8'): {
        'link': 'https://t.me/CaltOf/214',
        'name': '–ò–Ω—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤–Ω—ã–π –Ω–∞—É—á–Ω—ã–π –≤–∏–∑—É–∞–ª–∏–∑–∞—Ç–æ—Ä'
    },
    ('type4', 'type5', 'type6'): {
        'link': 'https://t.me/CaltOf/216',
        'name': '–°–æ—Ü–∏–∞–ª—å–Ω—ã–π –∫–∏–Ω–µ—Å—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π –º—É–∑—ã–∫–∞–Ω—Ç'
    },
    ('type4', 'type5', 'type7'): {
        'link': 'https://t.me/CaltOf/218',
        'name': '–ú—É–∑—ã–∫–∞–ª—å–Ω–æ-–∫–∏–Ω–µ—Å—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π –∏–Ω—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤'
    },
    ('type4', 'type5', 'type8'): {
        'link': 'https://t.me/CaltOf/220',
        'name': '–ú—É–∑—ã–∫–∞–ª—å–Ω–æ-–∫–∏–Ω–µ—Å—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π –Ω–∞—Ç—É—Ä–∞–ª–∏—Å—Ç'
    },
    ('type4', 'type6', 'type7'): {
        'link': 'https://t.me/CaltOf/222',
        'name': '–≠–º–ø–∞—Ç–∏—á–Ω—ã–π –º—É–∑—ã–∫–∞–ª—å–Ω—ã–π –º–µ–¥–∏—Ç–∞—Ç–æ—Ä'
    },
    ('type4', 'type6', 'type8'): {
        'link': 'https://t.me/CaltOf/224',
        'name': '–ú—É–∑—ã–∫–∞–ª—å–Ω—ã–π –Ω–∞—É—á–Ω—ã–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ç–æ—Ä'
    },
    ('type4', 'type7', 'type8'): {
        'link': 'https://t.me/CaltOf/226',
        'name': '–ú—É–∑—ã–∫–∞–ª—å–Ω—ã–π –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å-—Å–æ–∑–µ—Ä—Ü–∞—Ç–µ–ª—å'
    },
    ('type5', 'type6', 'type7'): {
        'link': 'https://t.me/CaltOf/228',
        'name': '–≠–º–ø–∞—Ç–∏—á–Ω—ã–π –∫–∏–Ω–µ—Å—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å'
    },
    ('type5', 'type6', 'type8'): {
        'link': 'https://t.me/CaltOf/230',
        'name': '–≠–º–ø–∞—Ç–∏—á–Ω—ã–π –Ω–∞—É—á–Ω—ã–π –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å'
    },
    ('type5', 'type7', 'type8'): {
        'link': 'https://t.me/CaltOf/232',
        'name': '–°–∞–º–æ–∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏—Ä–æ–¥–Ω—ã–π –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å'
    },
    ('type6', 'type7', 'type8'): {
        'link': 'https://t.me/CaltOf/234',
        'name': '–≠–º–ø–∞—Ç–∏—á–Ω—ã–π –Ω–∞—É—á–Ω—ã–π –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å'
    },
    # –î–æ–±–∞–≤—å—Ç–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏
}


# –ù–∞—á–∞–ª—å–Ω–æ–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
async def start(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    user_first_name = update.effective_user.first_name
    context.user_data['selected_types'] = []
    message = (
        f"–ü—Ä–∏–≤–µ—Ç, {user_first_name}! –Ø –≤–∞—à –±–æ—Ç –∏ —è –ø–æ–º–æ–≥—É –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤–∞—à —Ç–∏–ø –ª–∏—á–Ω–æ—Å—Ç–∏. –°—É—â–µ—Å—Ç–≤—É–µ—Ç 8 —Ç–∏–ø–æ–≤ –ª–∏—á–Ω–æ—Å—Ç–∏:\n"
        "–í—ã –º–æ–∂–µ—Ç–µ –Ω–∞–∂–∞—Ç—å –Ω–∞ –ª—é–±—É—é –∫–Ω–æ–ø–∫—É, —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ –æ –∫–∞–∂–¥–æ–º —Ç–∏–ø–µ:\n"
    )
    keyboard = [
        [InlineKeyboardButton(PERSONALITY_NAMES[f'type{i}'], url=PERSONALITY_LINKS[f'type{i}'])]
        for i in range(1, 9)
    ]
    # –ò–∑–º–µ–Ω—è–µ–º —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏, –¥–æ–±–∞–≤–ª—è—è —ç–º–æ–¥–∑–∏ –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è
    keyboard.append([InlineKeyboardButton("üöÄ –ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç üöÄ", callback_data='start_test')])
    reply_markup = InlineKeyboardMarkup(keyboard)

    if update.message:
        await update.message.reply_text(message, reply_markup=reply_markup)
    elif update.callback_query:
        await update.callback_query.edit_message_text(message, reply_markup=reply_markup)


# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã —Å –æ—Ç–º–µ—á–µ–Ω–Ω—ã–º–∏ –∫–Ω–æ–ø–∫–∞–º–∏
def generate_keyboard(selected_types):
    keyboard = []
    for i in range(1, 9):
        type_key = f'type{i}'
        text = PERSONALITY_NAMES[type_key]
        if type_key in selected_types:
            text += ' ‚úì'
        keyboard.append([InlineKeyboardButton(text, callback_data=type_key)])
    return keyboard


# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–æ–≤ –ª–∏—á–Ω–æ—Å—Ç–∏
async def button(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    query = update.callback_query
    await query.answer()

    selected_type = query.data

    if selected_type == 'retry':
        context.user_data['selected_types'] = []
        await start(update, context)
        return
    elif selected_type == 'start_test':
        keyboard = generate_keyboard([])
        reply_markup = InlineKeyboardMarkup(keyboard)
        await query.edit_message_text(
            text="–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ 3 —Ç–∏–ø–∞, –∫–æ—Ç–æ—Ä—ã–µ –≤–∞–º –ø–æ–¥—Ö–æ–¥—è—Ç –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ.",
            reply_markup=reply_markup
        )
        return

    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —Ç–∏–ø—ã –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    if 'selected_types' not in context.user_data:
        context.user_data['selected_types'] = []

    if selected_type not in context.user_data['selected_types']:
        context.user_data['selected_types'].append(selected_type)

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤—ã–±—Ä–∞–ª –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å 3 —Ç–∏–ø–∞
    if len(context.user_data['selected_types']) == 3:
        selected_types = tuple(sorted(context.user_data['selected_types']))
        if selected_types in COMBINATION_DESCRIPTIONS:
            combination = COMBINATION_DESCRIPTIONS[selected_types]
            link = combination['link']
            name = combination['name']
            keyboard = [[InlineKeyboardButton(name, url=link)]]
        else:
            name = "–ö–æ–º–±–∏–Ω–∞—Ü–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"
            link = "https://example.com/default"  # —Å—Å—ã–ª–∫–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            keyboard = [[InlineKeyboardButton(name, url=link)]]
        # –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–∞
        keyboard.append([InlineKeyboardButton("–ü—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç –∑–∞–Ω–æ–≤–æ", callback_data='retry')])
        reply_markup = InlineKeyboardMarkup(keyboard)
        await query.edit_message_text(text="–í–∞—à —Ç–∏–ø –ª–∏—á–Ω–æ—Å—Ç–∏:", reply_markup=reply_markup)
    else:
        keyboard = generate_keyboard(context.user_data['selected_types'])
        reply_markup = InlineKeyboardMarkup(keyboard)
        await query.edit_message_text(
            text=f"–í—ã –≤—ã–±—Ä–∞–ª–∏ —Ç–∏–ø {PERSONALITY_NAMES[selected_type]}. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –µ—â–µ {3 - len(context.user_data['selected_types'])} —Ç–∏–ø–∞.",
            reply_markup=reply_markup
        )


def main() -> None:
    # –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –ø–µ—Ä–µ–¥–∞–µ–º –µ–º—É —Ç–æ–∫–µ–Ω
    application = Application.builder().token(TOKEN).build()

    # –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥
    application.add_handler(CommandHandler("start", start))
    application.add_handler(CallbackQueryHandler(button))

    # –ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞
    application.run_polling()


if __name__ == '__main__':
    main()
